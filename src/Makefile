############################################################
#
# ffsrv Makefile
# 	Generated by amyznikov at Mar 15, 2016
#
############################################################

SHELL=/bin/bash

LIBNAME=ffsrv

TARGET=lib$(LIBNAME).a

cross   =
sysroot =
DESTDIR =

prefix  = /usr/local
bindir  = $(prefix)/bin
incdir  = $(prefix)/include
libdir  = $(prefix)/lib
pkgconfig_dir=$(libdir)/pkgconfig
pkgconfig_pc=$(pkgconfig_dir)/$(LIBNAME).pc

all: lib


SUBDIRS = .

INCLUDES+=$(foreach s,$(SUBDIRS),-I$(s))
SOURCES = $(foreach s,$(SUBDIRS),$(wildcard $(s)/*.c))
HEADERS = $(foreach s,$(SUBDIRS),$(wildcard $(s)/*.h))
MODULES = $(foreach s,$(SOURCES),$(addsuffix .o,$(basename $(s))))
DEFINES =



# C preprocessor flags
CPPFLAGS =

# C Compiler and flags
CC = $(cross)gcc
CFLAGS = -Wall -Wextra -Wno-deprecated-declarations -g3 -O3 $(DEFINES) $(INCLUDES)


$(MODULES): $(HEADERS)

lib : $(TARGET)($(MODULES))
clean : ; $(RM) $(MODULES)
distclean: clean ; $(RM) $(TARGET)


$(incdir) :
	mkdir -p $@

$(libdir) :
	mkdir -p $@

$(pkgconfig_dir) :
	mkdir -p $@

install: $(TARGET) $(incdir) $(libdir) $(pkgconfig_dir)
	cp $(TARGET) $(libdir)/
	echo "prefix=$(prefix)" > $(pkgconfig_pc)
	echo "exec_prefix=$(prefix)" >> $(pkgconfig_pc)
	echo "libdir=$(libdir)" >> $(pkgconfig_pc)
	echo "incdir=$(incdir)" >> $(pkgconfig_pc)
	echo "" >> $(pkgconfig_pc)
	echo "Name: $(LIBNAME)" >> $(pkgconfig_pc)
	echo "Description: $(LIBNAME) library"  >> $(pkgconfig_pc)
	echo "Version: $(VERSION)" >> $(pkgconfig_pc)
	echo "Requires:"  >> $(pkgconfig_pc)
	echo "Requires.private:" >> $(pkgconfig_pc)
	echo "Conflicts:" >> $(pkgconfig_pc)
	echo "Libs: -L${libdir} -l$(LIBNAME)"  >> $(pkgconfig_pc)
	echo "Libs.private:" >> $(pkgconfig_pc)
	echo "Cflags: -I${incdir}" >> $(pkgconfig_pc)

uninstall:
	$(RM) $(libdir)/$(TARGET)
	$(RM) $(pkgconfig_pc)
